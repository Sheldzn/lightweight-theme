function F(){if(typeof window>"u"||!window.fetch||!window.Intl||!window.FormData)return;var n=document.getElementById("lw-cart-drawer");if(!n)return;var A=n.querySelector("[data-cart-drawer-overlay]"),c=n.querySelector("[data-cart-drawer-panel]"),o=n.querySelector("[data-cart-drawer-items]"),l=n.querySelector("[data-cart-drawer-empty]"),S=n.querySelector("[data-cart-drawer-subtotal]"),p=n.querySelectorAll("[data-cart-drawer-close]"),b=n.querySelector("[data-cart-drawer-line-template]"),N=c&&c.getAttribute("data-shop-currency")||"USD",g=new Intl.NumberFormat(void 0,{style:"currency",currency:N}),h=!1,y=null;function D(e){!n||!c||(e?(n.setAttribute("aria-hidden","false"),n.classList.remove("tw:pointer-events-none","tw:invisible"),n.classList.add("tw:pointer-events-auto","tw:visible"),c.classList.remove("tw:translate-x-full"),c.classList.add("tw:translate-x-0")):(n.classList.add("tw:pointer-events-none"),n.classList.remove("tw:pointer-events-auto"),c.classList.add("tw:translate-x-full"),c.classList.remove("tw:translate-x-0")))}function O(){n&&(n.setAttribute("aria-hidden","true"),n.classList.remove("tw:visible"),n.classList.add("tw:invisible"))}function _(e){y=document.activeElement,e&&C(e),D(!0),h=!0;var r=n.querySelector("[data-cart-drawer-close]");r&&typeof r.focus=="function"&&r.focus(),document.addEventListener("keydown",k)}function v(){h=!1,document.removeEventListener("keydown",k),D(!1);function e(){c.removeEventListener("transitionend",e),clearTimeout(r),!h&&(O(),y&&typeof y.focus=="function"&&y.focus())}var r=setTimeout(e,220);c.addEventListener("transitionend",e)}function k(e){h&&(e.key==="Escape"||e.key==="Esc")&&(e.preventDefault(),v())}function C(e){if(!(!e||!Array.isArray(e.items))&&!(!o||!l||!S)){if(e.items.length===0)l.classList.remove("tw:hidden"),l.hidden=!1,o.innerHTML="",o.classList.add("tw:hidden"),o.hidden=!0;else if(b&&b.content){l.classList.add("tw:hidden"),l.hidden=!0,o.classList.remove("tw:hidden"),o.hidden=!1;for(var r=document.createDocumentFragment(),i=0;i<e.items.length&&i<10;i+=1){var t=e.items[i],u=b.content.cloneNode(!0),d=u.firstElementChild;if(d){d.setAttribute("data-cart-line-key",t.key);var a=d.querySelector("[data-cart-line-image]");a&&(t.image?(a.src=t.image,a.alt=t.product_title||t.title||"",a.classList.remove("tw:hidden")):a.classList.add("tw:hidden"));var w=d.querySelector("[data-cart-line-title]");w&&(w.textContent=t.product_title||t.title||"");var s=d.querySelector("[data-cart-line-variant]");s&&(t.variant_title&&t.variant_title!=="Default Title"?(s.textContent=t.variant_title,s.hidden=!1):s.hidden=!0);var f=d.querySelector("[data-cart-line-qty]");f&&(f.textContent=String(t.quantity));var T=String(t.quantity),L=d.querySelector('[data-cart-qty-change="decrement"]'),q=d.querySelector('[data-cart-qty-change="increment"]');L&&(L.setAttribute("data-line-key",t.key),L.setAttribute("data-current-qty",T)),q&&(q.setAttribute("data-line-key",t.key),q.setAttribute("data-current-qty",T));var j=typeof t.original_line_price=="number"&&typeof t.final_line_price=="number"&&t.original_line_price>t.final_line_price,x=d.querySelector("[data-cart-line-price]");if(x){var H=j?t.final_line_price:t.line_price;x.textContent=g.format(H/100)}var m=d.querySelector("[data-cart-line-original]");m&&(j?(m.textContent=g.format(t.original_line_price/100),m.classList.remove("tw:hidden")):m.classList.add("tw:hidden")),r.appendChild(d)}}o.innerHTML="",o.appendChild(r)}else l.classList.add("tw:hidden"),l.hidden=!0,o.classList.remove("tw:hidden"),o.hidden=!1,o.innerHTML="";S.textContent=g.format(e.total_price/100)}}function E(e){var r=e.target;if(r&&r.nodeName!=="FORM"&&r.closest&&(r=r.closest("form")),!r||!r.matches||!r.matches('form[action*="/cart/add"]')||!window.fetch||!window.FormData)return;e.preventDefault();var i=e.submitter;if(i&&i.nodeName==="BUTTON"){i.setAttribute("data-cart-add-busy","true"),i.disabled=!0;var t=document.createElement("span");t.setAttribute("data-cart-add-spinner",""),t.className="tw:hidden tw:ml-2 tw:inline-flex tw:w-4 tw:h-4 tw:rounded-full tw:border-2 tw:border-current tw:border-t-transparent tw:animate-spin",t.setAttribute("aria-hidden","true"),i.appendChild(t)}var u=new FormData(r);function d(){if(i&&i.nodeName==="BUTTON"){i.removeAttribute("data-cart-add-busy"),i.disabled=!1;var a=i.querySelector("[data-cart-add-spinner]");a&&a.remove()}}fetch("/cart/add.js",{method:"POST",headers:{Accept:"application/json"},body:u,credentials:"same-origin"}).then(function(a){if(!a.ok)throw new Error("Add to cart failed");return a.json()}).then(function(){return fetch("/cart.js",{credentials:"same-origin"})}).then(function(a){if(!a.ok)throw new Error("Cart request failed");return a.json()}).then(function(a){_(a),d()}).catch(function(){d(),v(),window.location.href="/cart"})}function M(e){var r=e.target,i=r.closest&&r.closest("[data-cart-drawer-trigger]");if(i){e.preventDefault(),_();return}if(r.closest&&r.closest("[data-cart-drawer-close]")){e.preventDefault(),v();return}if(A&&r===A){e.preventDefault(),v();return}var t=r.closest?r.closest("[data-cart-qty-change]"):null;if(t){e.preventDefault();var u=t.getAttribute("data-line-key"),d=t.getAttribute("data-cart-qty-change"),a=parseInt(t.getAttribute("data-current-qty")||"0",10);if(!u||!d||!a||a<0)return;var w=d==="increment"?a+1:a-1;w<0&&(w=0);var s=o.querySelector('[data-cart-line-key="'+u+'"]');s&&s.setAttribute("data-loading","true"),fetch("/cart/change.js",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({id:u,quantity:w})}).then(function(f){if(!f.ok)throw new Error("Quantity change failed");return f.json()}).then(function(f){C(f)}).catch(function(){s&&s.removeAttribute("data-loading"),window.location.href="/cart"})}}document.addEventListener("submit",E,!0),document.addEventListener("click",M),p&&p.length>0&&Array.prototype.forEach.call(p,function(e){e.addEventListener("click",function(r){r.preventDefault(),v()})})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",F):F();
